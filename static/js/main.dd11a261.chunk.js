(this.webpackJsonpxmind=this.webpackJsonpxmind||[]).push([[0],{175:function(e,t,a){e.exports=a(325)},180:function(e,t,a){},181:function(e,t,a){},182:function(e,t,a){},325:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(16),o=a.n(r),i=(a(180),a(181),a(121)),s=a.n(i),l=a(144),u=a(93),d=a(62),m=a(58),f=a(39),b=a(45),h=a.n(b),p=a(90),v=a(328),O=a(331),y=a(332),j=a(40),g=a(326),E=a(329),S=a(327),w=(a(182),a(145)),x=a.n(w),C=a(330),k=function(e){var t=e||{},a=t.title,n=void 0===a?"Click to upload CSV file":a,r=t.onFileLoaded,o=void 0===r?function(){}:r,i=t.fileName,s=void 0===i?"":i,l=t.setFileName,u=void 0===l?function(){}:l,d=function(e){var t=e.target||{},a=t.readyState,n=t.result;2===a&&function(e){var t=x.a.parse(e,{header:!0});o(t)}(n)},m=function(e){"NotReadableError"===e.target.error.name&&O.b.error("Canno't read file !")};return c.a.createElement(j.a,{className:I,type:"primary"},s||n,c.a.createElement(C.a,{type:"file",onChange:function(e){var t=e.target.files;if(t&&t[0]){u(t[0].name);var a=new FileReader;a.readAsText(t[0]),a.onload=d,a.onerror=m}},accept:".csv",className:"inputFile"}))},I="bg-c-papaparser",F="YYYY-MM-DD",N=p.a.Option,A=h()().utcOffset();var M=function(){var e=Object(n.useState)([]),t=Object(f.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)({}),i=Object(f.a)(o,2),b=i[0],w=i[1],x=Object(n.useState)(!1),C=Object(f.a)(x,2),I=C[0],M=C[1],Y=Object(n.useState)(),B=Object(f.a)(Y,2),V=B[0],W=B[1],q=Object(n.useState)(),L=Object(f.a)(q,2),P=L[0],R=L[1],D=Object(n.useState)(),J=Object(f.a)(D,2),H=J[0],K=J[1],$=Object(n.useState)(),z=Object(f.a)($,2),G=z[0],Q=z[1],U=Object(n.useState)(),X=Object(f.a)(U,2),Z=X[0],_=X[1],ee=Object(n.useState)(),te=Object(f.a)(ee,2),ae=te[0],ne=te[1],ce=Object(n.useState)(!1),re=Object(f.a)(ce,2),oe=re[0],ie=re[1],se=Object(n.useState)([]),le=Object(f.a)(se,2),ue=le[0],de=le[1],me=Object(n.useState)([]),fe=Object(f.a)(me,2),be=fe[0],he=fe[1],pe=Object(n.useState)(!1),ve=Object(f.a)(pe,2),Oe=ve[0],ye=ve[1],je=Object(n.useState)(),ge=Object(f.a)(je,2),Ee=ge[0],Se=ge[1],we=Object(n.useState)(""),xe=Object(f.a)(we,2),Ce=xe[0],ke=xe[1],Ie=Object(n.useState)(""),Fe=Object(f.a)(Ie,2),Ne=Fe[0],Ae=Fe[1],Me=v.a.useForm(),Te=Object(f.a)(Me,1)[0];Object(n.useEffect)((function(){var e=[],t={},a=be;if(H&&G&&(a=a.filter((function(e){return e.year===H&&e.month===G}))),a.forEach((function(a){var n;e.push((n={},Object(m.a)(n,a.category,a.amount),Object(m.a)(n,"date",a.fullString),Object(m.a)(n,"year",a.year),Object(m.a)(n,"month",a.month),Object(m.a)(n,"day",a.date),Object(m.a)(n,"id","".concat(a.time,"-").concat(a.category,"-").concat(a.amount)),n)),H&&G&&(t[a.category]?t[a.category]=t[a.category]+a.amount:(t[a.category]=a.amount,t.id="columnSum",t.outcome=0,t.income=0,t.date="".concat(a.year,"-").concat(a.month)))})),Object.keys(t).length>0)for(var n=0,c=Object.keys(t);n<c.length;n++){var r=c[n];b[r]&&(0===b[r].type?t.outcome=t.outcome+t[r]:1===b[r].type&&(t[r]>0?t.income=t.income+t[r]:t.outcome=t.outcome-t[r]))}var o=e.sort((function(e,t){return e.year-t.year||e.month-t.month||e.day-t.day}));H&&G&&(o=[t].concat(Object(d.a)(o))),_(o);var i=Be(t);ne(i)}),[I,Oe,be,H,G]);var Ye=function(e){var t=[],a={},n=new Set;e.forEach((function(e){var c=e.time-0,r=function(e){var t=h()().utcOffset(),a=h()(e).utcOffset(t);return{date:a.date(),month:a.month()+1,year:a.year(),fullString:a.format(F)}}(c),o=r.year,i=r.month,s=r.fullString,l=r.date;return n.add(o),a[o]||(a[o]=new Set,a[o].add(0)),a[o].add(i),t.push({type:e.type-0,category:e.category,time:c,amount:e.amount-0,year:o,month:i,date:l,fullString:s})})),W(Object(d.a)(n.values()).sort((function(e,t){return e-t}))),R(a),he(t),ye(!0)},Be=function(e){var t=[];a.forEach((function(e){return t.push({title:e.name,dataIndex:e.id})}));var n=[],c=[];t.forEach((function(t){0===b[t.dataIndex].type?n.push(t):1===b[t.dataIndex].type&&(e[t.dataIndex]>0?c.push(t):n.push(t))})),n=n.sort((function(t,a){return Math.abs(e[a.dataIndex]||0)-Math.abs(e[t.dataIndex]||0)})),c=c.sort((function(t,a){return Math.abs(e[t.dataIndex]||0)-Math.abs(e[a.dataIndex]||0)}));return[].concat([{title:"\u65e5\u671f",dataIndex:"date"}],Object(d.a)(n),Object(d.a)(c),Object(d.a)(H&&G?[{title:"\u6536\u5165",dataIndex:"income"},{title:"\u652f\u51fa",dataIndex:"outcome"}]:[]))},Ve=function(){var e=Object(l.a)(s.a.mark((function e(){var t,a,n,c;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Te.validateFields();case 3:t=e.sent,a=h()(t.time).utcOffset(A).valueOf(),n=Object(u.a)(Object(u.a)({},t),{},{time:a,type:b[t.category].type}),c=[].concat(Object(d.a)(ue),[n]),de(c),Ye(c),ie(!1),Te.setFieldsValue({time:"",category:"",amount:""}),O.b.success("Row added successed!"),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("Failed:",e.t0);case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(){return e.apply(this,arguments)}}();return c.a.createElement("div",{className:T},c.a.createElement("div",{className:"header"},!I&&c.a.createElement(k,{fileName:Ce,setFileName:ke,title:"Click to upload Categories CSV file",onFileLoaded:function(e){var t=e||{},a=t.data,n=void 0===a?[]:a,c=t.errors,o=t.meta;if(Array.isArray(c)&&0===c.length){var i=(o||{}).fields,s=void 0===i?[]:i;if(!s.includes("id")||!s.includes("name")||!s.includes("type")||3!==s.length)return O.b.warn("This is not categories.csv, please choose categories.csv"),void ke("");r(n);var l={};n.forEach((function(e){l[e.id]=Object(u.a)(Object(u.a)({},e),{},{type:e.type-0})})),w(l),M(!0),O.b.success("File added successed!")}else console.error("handleCategories errors",c)}}),!Oe&&c.a.createElement(k,{fileName:Ne,setFileName:Ae,title:"Click to upload Bill CSV file",onFileLoaded:function(e){var t=e||{},a=t.data,n=void 0===a?[]:a,c=t.errors,r=t.meta;if(Array.isArray(c)&&0===c.length){var o=(r||{}).fields,i=void 0===o?[]:o;if(!i.includes("amount")||!i.includes("category")||!i.includes("time")||!i.includes("type")||4!==i.length)return O.b.warn("This is not bill.csv, please choose bill.csv"),void Ae("");de(n),Ye(n),O.b.success("File added successed!")}else console.error("handleBill errors",c)}}),I&&Oe&&c.a.createElement("div",{className:"selector"},V&&V.length>0&&c.a.createElement(p.a,{placeholder:"Select Year",style:{width:"auto",minWidth:"100px"},onChange:function(e){K(e),Q(0)},value:H},V.map((function(e){return c.a.createElement(N,{key:e,value:e},e)}))),H&&P&&P[H]&&Object(d.a)(P[H].values()).length>0&&c.a.createElement(p.a,{placeholder:"Select Month",style:{width:"auto",minWidth:"100px"},onChange:function(e){return Q(e)},value:G},Object(d.a)(P[H].values()).map((function(e){return c.a.createElement(N,{key:e,value:e},0===e?"None":e)})))),I&&Oe&&c.a.createElement(j.a,{onClick:function(){return ie(!0)},type:"primary"},"Add a row")),c.a.createElement("div",{className:"content"},I&&Oe&&c.a.createElement(g.a,{columns:ae,dataSource:Z,rowKey:"id",pagination:!1,scroll:{y:"".concat(document.body.clientHeight-100,"px")},style:{width:"100%"}})),oe&&c.a.createElement(E.a,{title:"Add a row",visible:!0,onOk:Ve,onCancel:function(){return ie(!1)}},c.a.createElement(v.a,Object.assign({},{labelCol:{span:6},wrapperCol:{span:18}},{name:"basic",form:Te}),c.a.createElement(v.a.Item,{label:"Time",name:"time",rules:[{required:!0,message:"Please choose time!"}]},c.a.createElement(S.a,{showTime:!0})),c.a.createElement(v.a.Item,{label:"Category",name:"category",rules:[{required:!0,message:"Please choose category!"}]},c.a.createElement(p.a,{onChange:function(e){return Se(e)}},a.map((function(e){return c.a.createElement(p.a.Option,{key:e.id,value:e.id},e.name)})))),c.a.createElement(v.a.Item,{label:"Amount",name:"amount",rules:[{required:!0,message:"Please input amount!"}]},Ee&&["1vjj47vpd28","5il79e11628"].includes(Ee)?c.a.createElement(y.a,{step:100}):c.a.createElement(y.a,{min:1,step:100})))))},T="bg-c-app";Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[175,1,2]]]);
//# sourceMappingURL=main.dd11a261.chunk.js.map